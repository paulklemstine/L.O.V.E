{
  "user_stories": [
    {
      "title": "Establish Project Structure and Dependency Core",
      "description": "CONTEXT (Parent Story):\n**Title:** Epic Refactor: Reducing Cyclomatic Complexity and Enhancing Type Safety in `love.py`\n\n**Description:**\n\nThe `love.py` file acts as the central nervous system for the L.O.V.E. project, handling everything from dependency management and environment setup to process orchestration and state persistence. However, its current implementation has resulted in a Cyclomatic Complexity score of 512. This high complexity stems from deeply nested conditional logic, heavy use of global state, lack o...\n\nSPECIFIC TASK:\nCreate the `core/` directory structure. Implement `core/exceptions.py` to define custom exceptions (`DependencyInstallationError`, `ServiceStartupError`, `HotRestartSignal`). Implement `core/dependencies.py` containing the `resolve_dependency` function and `install_package` helper, removing the scattered `try/except` blocks from the main `love.py` file. This creates a centralized 'Pre-flight' system.",
      "id": "3fec8b94-2d68-4841-b6fa-4201288ab3b5"
    },
    {
      "title": "Implement Type-Safe Configuration Management",
      "description": "CONTEXT (Parent Story):\n**Title:** Epic Refactor: Reducing Cyclomatic Complexity and Enhancing Type Safety in `love.py`\n\n**Description:**\n\nThe `love.py` file acts as the central nervous system for the L.O.V.E. project, handling everything from dependency management and environment setup to process orchestration and state persistence. However, its current implementation has resulted in a Cyclomatic Complexity score of 512. This high complexity stems from deeply nested conditional logic, heavy use of global state, lack o...\n\nSPECIFIC TASK:\nCreate `core/config.py`. Define a `LoveConfig` dataclass (using `dataclasses` or `pydantic`) that maps strictly to the existing `Config` and `VRAM_MODEL_MAP` structure. Implement a `StateStore` singleton class to replace the global `shared_state` dictionary, providing strict getter/setter methods. This prepares the 'Blueprint' phase.",
      "id": "83c8ed13-9325-40a7-8243-42ea115fcce2"
    },
    {
      "title": "Extract Asynchronous Service Management",
      "description": "CONTEXT (Parent Story):\n**Title:** Epic Refactor: Reducing Cyclomatic Complexity and Enhancing Type Safety in `love.py`\n\n**Description:**\n\nThe `love.py` file acts as the central nervous system for the L.O.V.E. project, handling everything from dependency management and environment setup to process orchestration and state persistence. However, its current implementation has resulted in a Cyclomatic Complexity score of 512. This high complexity stems from deeply nested conditional logic, heavy use of global state, lack o...\n\nSPECIFIC TASK:\nCreate `core/service_manager.py`. Migrate the synchronous `subprocess.Popen` calls for `ws_proxy.py` and `server.py` to `asyncio.create_subprocess_exec`. Convert `is_port_in_use` into an async-compatible check (using `asyncio` sockets). Wrap these operations in an `AsyncServiceManager` class with an `async start_all()` method that uses `asyncio.gather`.",
      "id": "2b725feb-48ff-4f78-8486-640d0c918320"
    },
    {
      "title": "Refactor Legacy Patches and Logging",
      "description": "CONTEXT (Parent Story):\n**Title:** Epic Refactor: Reducing Cyclomatic Complexity and Enhancing Type Safety in `love.py`\n\n**Description:**\n\nThe `love.py` file acts as the central nervous system for the L.O.V.E. project, handling everything from dependency management and environment setup to process orchestration and state persistence. However, its current implementation has resulted in a Cyclomatic Complexity score of 512. This high complexity stems from deeply nested conditional logic, heavy use of global state, lack o...\n\nSPECIFIC TASK:\nCreate `core/runtime_patches.py`. Move all logic currently inside `apply_stability_patches` (transformer patching) and standard output/stream reconfiguration into dedicated functions (`apply_runtime_patches`, `initialize_logging`). Strip these blocks out of `love.py` to clean up the global namespace.",
      "id": "7abb5d4e-cc4c-4c1b-a275-d9840f47dc86"
    },
    {
      "title": "Implement the `LoveEngine` Core Class",
      "description": "CONTEXT (Parent Story):\n**Title:** Epic Refactor: Reducing Cyclomatic Complexity and Enhancing Type Safety in `love.py`\n\n**Description:**\n\nThe `love.py` file acts as the central nervous system for the L.O.V.E. project, handling everything from dependency management and environment setup to process orchestration and state persistence. However, its current implementation has resulted in a Cyclomatic Complexity score of 512. This high complexity stems from deeply nested conditional logic, heavy use of global state, lack o...\n\nSPECIFIC TASK:\nRefactor `love.py` to remove top-level procedural startup logic. Define a `LoveEngine` class with a `start()` method. This method will strictly orchestrate the execution flow in sequence: 1. Initialize Logging/Patches, 2. Resolve Dependencies via `DependencyManager`, 3. Initialize `GodAgent`/`MemoryManager`, 4. Start WebVM services via `AsyncServiceManager`, and 5. Enter the main loop. This encapsulates the 'Heart' phase.",
      "id": "7a4acc76-c460-437c-9ff0-a19e14a4f1f1"
    },
    {
      "title": "Implement Hot Restart Loop and Error Handling",
      "description": "CONTEXT (Parent Story):\n**Title:** Epic Refactor: Reducing Cyclomatic Complexity and Enhancing Type Safety in `love.py`\n\n**Description:**\n\nThe `love.py` file acts as the central nervous system for the L.O.V.E. project, handling everything from dependency management and environment setup to process orchestration and state persistence. However, its current implementation has resulted in a Cyclomatic Complexity score of 512. This high complexity stems from deeply nested conditional logic, heavy use of global state, lack o...\n\nSPECIFIC TASK:\nModify the `main()` wrapper function in `love.py`. Replace the raw `sys.exit(42)` calls with a custom `HotRestartSignal` exception. Implement a `while True` loop in `main()` that instantiates `LoveEngine`, calls `engine.start()`, and catches `HotRestartSignal` to restart the loop cleanly. Add specific exception handling for `DependencyInstallationError` upstream.",
      "id": "aa280066-b0c2-4348-ac92-32112d9cf9d6"
    },
    {
      "title": "Apply Strict Type Hinting to `love.py`",
      "description": "CONTEXT (Parent Story):\n**Title:** Epic Refactor: Reducing Cyclomatic Complexity and Enhancing Type Safety in `love.py`\n\n**Description:**\n\nThe `love.py` file acts as the central nervous system for the L.O.V.E. project, handling everything from dependency management and environment setup to process orchestration and state persistence. However, its current implementation has resulted in a Cyclomatic Complexity score of 512. This high complexity stems from deeply nested conditional logic, heavy use of global state, lack o...\n\nSPECIFIC TASK:\nConduct a final pass on `love.py`. Annotate all function signatures, class attributes, and variable assignments with Python type hints (e.g., `config: LoveConfig`, `def start(self) -> None`, `async def start_webvm_services(...)`). Ensure `from typing import ...` is used correctly. This finalizes the 'Safety' phase.",
      "id": "973996a2-9f81-4ee6-9e25-1dc006af4c3d"
    }
  ],
  "current_story_index": 0,
  "active": true,
  "current_task_id": null
}